Mario.ImprovedNoise=function(i){this.P=[],this.Shuffle(i)},Mario.ImprovedNoise.prototype={Shuffle:function(i){for(var t,r,s=[],h=0,h=0;h<256;h++)s[h]=h;for(h=0;h<256;h++)t=(255*Math.random()|0)+h,r=s[h],s[h]=s[t],s[t]=r,this.P[h+256]=this.P[h]=s[h]},PerlinNoise:function(i,t){for(var r,s=0,h=0,s=0;s<8;s++)r=64/(1<<s),h+=this.Noise(i/r,t/r,128)/(1<<s);return h},Noise:function(i,t,r){var s=255&(0|i),h=255&(0|t),e=255&(0|r);i-=0|i,t-=0|t,r-=0|r;var a=this.Fade(i),o=this.Fade(t),n=this.Fade(r),P=this.P[s]+h,d=this.P[P]+e,f=this.P[P+1]+e,u=this.P[1+s]+h,p=this.P[u]+e,G=this.P[u+1]+e;return this.Lerp(n,this.Lerp(o,this.Lerp(a,this.Grad(this.P[d],i,t,r),this.Grad(this.P[p],i-1,t,r)),this.Lerp(a,this.Grad(this.P[f],i,t-1,r),this.Grad(this.P[G],i-1,t-1,r))),this.Lerp(o,this.Lerp(a,this.Grad(this.P[d+1],i,t,r-1),this.Grad(this.P[p+1],i-1,t,r-1)),this.Lerp(a,this.Grad(this.P[f+1],i,t-1,r-1),this.Grad(this.P[G+1],i-1,t-1,r-1))))},Fade:function(i){return i*i*i*(i*(6*i-15)+10)},Lerp:function(i,t,r){return t+i*(r-t)},Grad:function(i,t,r,s){var h=15&i,e=h<8?t:r,a=h<4?r:12==h||14==h?t:s;return(0==(1&h)?e:-e)+(0==(2&h)?a:-a)}};