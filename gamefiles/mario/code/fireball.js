Mario.Fireball=function(i,t,h,s){this.GroundInertia=.89,this.AirInertia=.89,this.Image=Enjine.Resources.Images.particles,this.World=i,this.X=t,this.Y=h,this.Facing=s,this.XPicO=4,this.YPicO=4,this.YPic=3,this.XPic=4,this.Height=8,this.Width=4,this.PicWidth=this.PicHeight=8,this.Ya=4,this.Dead=!1,this.DeadTime=0,this.Anim=0,this.OnGround=!1},Mario.Fireball.prototype=new Mario.NotchSprite,Mario.Fireball.prototype.Move=function(){var i=0;if(0<this.DeadTime){for(i=0;i<8;i++)this.World.AddSprite(new Mario.Sparkle(this.World,4+(this.X+8*Math.random()-4|0),2+(this.Y+8*Math.random()-4|0),2*Math.random()-this.Facing,2*Math.random()-1,0,1,5));this.World.RemoveSprite(this)}else 0!=this.Facing&&this.Anim++,2<this.Xa&&(this.Facing=1),this.Xa<-2&&(this.Facing=-1),this.Xa=8*this.Facing,this.World.CheckFireballCollide(this),this.FlipX=-1===this.Facing,this.XPic=this.Anim%4,this.SubMove(this.Xa,0)||this.Die(),this.OnGround=!1,this.SubMove(0,this.Ya),this.OnGround&&(this.Ya=-10),this.Ya*=.95,this.OnGround?this.Xa*=this.GroundInertia:this.Xa*=this.AirInertia,this.OnGround||(this.Ya+=1.5)},Mario.Fireball.prototype.SubMove=function(i,t){for(var h=!1;8<i;){if(!this.SubMove(8,0))return!1;i-=8}for(;i<-8;){if(!this.SubMove(-8,0))return!1;i+=8}for(;8<t;){if(!this.SubMove(0,8))return!1;t-=8}for(;t<-8;){if(!this.SubMove(0,-8))return!1;t+=8}return 0<t&&(this.IsBlocking(this.X+i-this.Width,this.Y+t,i,0)||this.IsBlocking(this.X+i+this.Width,this.Y+t,i,0)||this.IsBlocking(this.X+i-this.Width,this.Y+t+1,i,t)||this.IsBlocking(this.X+i+this.Width,this.Y+t+1,i,t))&&(h=!0),t<0&&(this.IsBlocking(this.X+i,this.Y+t-this.Height,i,t)||h||this.IsBlocking(this.X+i-this.Width,this.Y+t-this.Height,i,t)||h||this.IsBlocking(this.X+i+this.Width,this.Y+t-this.Height,i,t))&&(h=!0),0<i&&(this.IsBlocking(this.X+i+this.Width,this.Y+t-this.Height,i,t)&&(h=!0),this.IsBlocking(this.X+i+this.Width,this.Y+t-(this.Height/2|0),i,t)&&(h=!0),this.IsBlocking(this.X+i+this.Width,this.Y+t,i,t)&&(h=!0)),i<0&&(this.IsBlocking(this.X+i-this.Width,this.Y+t-this.Height,i,t)&&(h=!0),this.IsBlocking(this.X+i-this.Width,this.Y+t-(this.Height/2|0),i,t)&&(h=!0),this.IsBlocking(this.X+i-this.Width,this.Y+t,i,t)&&(h=!0)),h?(i<0&&(this.X=16*((this.X-this.Width)/16|0)+this.Width,this.Xa=0),0<i&&(this.X=16*((this.X+this.Width)/16+1|0)-this.Width-1,this.Xa=0),t<0&&(this.Y=16*((this.Y-this.Height)/16|0)+this.Height,this.Ya=0),0<t&&(this.Y=16*((this.Y-1)/16+1|0)-1,this.OnGround=!0),!1):(this.X+=i,this.Y+=t,!0)},Mario.Fireball.prototype.IsBlocking=function(i,t,h,s){return t=t/16|0,!((i=i/16|0)===this.X/16|0&&t===this.Y/16|0)&&this.World.Level.IsBlocking(i,t,h,s)},Mario.Fireball.prototype.Die=function(){this.Dead=!0,this.Xa=2*-this.Facing,this.Ya=-5,this.DeadTime=100};